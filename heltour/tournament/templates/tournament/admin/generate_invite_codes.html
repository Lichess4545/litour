{% extends "admin/base_site.html" %}
{% load static %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Home</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_label|capfirst|escape }}</a>
    &rsaquo; <a href="{% url 'admin:tournament_season_changelist' %}">Seasons</a>
    &rsaquo; {{ season }}
    &rsaquo; Generate Invite Codes
</div>
{% endblock %}

{% block content %}
<h1>Generate Invite Codes for {{ season }}</h1>

<div class="module">
    <h2>Current Invite Code Statistics</h2>
    <table>
        <tr>
            <th>Code Type</th>
            <th>Total</th>
            <th>Used</th>
            <th>Available</th>
        </tr>
        <tr>
            <td>Captain Codes</td>
            <td>{{ stats.captain_codes.total }}</td>
            <td>{{ stats.captain_codes.used }}</td>
            <td>{{ stats.captain_codes.available }}</td>
        </tr>
        <tr>
            <td>Team Member Codes</td>
            <td>{{ stats.team_codes.total }}</td>
            <td>{{ stats.team_codes.used }}</td>
            <td>{{ stats.team_codes.available }}</td>
        </tr>
        <tr>
            <th>Total</th>
            <th>{{ stats.total }}</th>
            <th>{{ stats.captain_codes.used|add:stats.team_codes.used }}</th>
            <th>{{ stats.captain_codes.available|add:stats.team_codes.available }}</th>
        </tr>
    </table>
</div>

<form method="post">
    {% csrf_token %}
    <div class="module">
        <h2>Generate New Codes</h2>
        <fieldset class="module aligned">
            <div class="form-row">
                <label for="id_code_type">Code Type:</label>
                <select name="code_type" id="id_code_type">
                    <option value="captain">Captain Code - Creates new team</option>
                    <option value="team_member">Team Member Code - Joins existing team</option>
                </select>
                <p class="help">Captain codes allow users to register and create a new team. Team member codes must be associated with an existing team.</p>
            </div>
            <div class="form-row">
                <label for="id_count">Number of codes:</label>
                <input type="number" name="count" id="id_count" min="1" max="10000" value="10" required>
                <p class="help">Enter the number of invite codes to generate (1-10,000)</p>
            </div>
        </fieldset>
    </div>
    <div class="submit-row">
        <input type="submit" value="Generate Codes" class="default">
    </div>
</form>

<div class="module">
    <h2>Notes</h2>
    <ul>
        <li>Generated codes will be in the format: WORD1-WORD2-XXXXXXXX (e.g., CHESS-KNIGHT-ABC12345)</li>
        <li>Each code can only be used once</li>
        <li>Captain codes create new teams with the registrant as captain</li>
        <li>Team member codes require association with an existing team (functionality coming soon)</li>
        <li>After generation, you can view and manage all codes in the <a href="{% url 'admin:tournament_invitecode_changelist' %}">Invite Codes admin</a></li>
    </ul>
</div>

{% endblock %}